# Улучшения дашборда

## Описание изменений

Были внесены изменения для замены статических метрик на реальные данные из базы данных.

### Изменения в бэкенде

1. **Новый эндпоинт для статистики дашборда**
   - Файл: `wildfire-backend/app/routers/health.py`
   - Эндпоинт: `GET /api/v1/health/dashboard-stats`
   - Возвращает реальные данные:
     - Активные пожары (за последние 24 часа)
     - Зоны высокого риска (предсказания с высоким риском за последние 7 дней)
     - Средняя точность прогноза (среднее значение confidence за последние 30 дней)
     - Активные команды (пока фиксированное значение)
     - Общее количество пожаров за месяц

2. **Используемые модели данных**
   - `FirePrediction` - для данных о предсказаниях
   - `HistoricalFire` - для исторических данных о пожарах

### Изменения во фронтенде

1. **Обновлен API сервис**
   - Файл: `frontend/src/services/api.js`
   - Добавлен метод `getDashboardStats()`

2. **Обновлена главная страница**
   - Файл: `frontend/src/pages/IndexPage.vue`
   - Заменены статические метрики на динамические
   - Добавлена обработка ошибок
   - Обновлены события (более реалистичные)

### Метрики, которые теперь привязаны к бэкенду

1. **Активные пожары**
   - Источник: `HistoricalFire` (за последние 24 часа)
   - Отображается: количество пожаров

2. **Зоны высокого риска**
   - Источник: `FirePrediction` (риск 'high' или 'extreme' за последние 7 дней)
   - Отображается: количество зон

3. **Точность прогноза**
   - Источник: среднее значение `confidence` из `FirePrediction` (за последние 30 дней)
   - Отображается: процент точности

4. **Активные команды**
   - Источник: фиксированное значение (пока)
   - Отображается: количество команд

5. **Общее количество пожаров за месяц**
   - Источник: `HistoricalFire` (за последние 30 дней)
   - Отображается: в блоке "Тренды пожаров"

### Удаленные статические метрики

- Убраны фиксированные значения для всех метрик
- Убраны нереалистичные события о пожарах
- Заменены на реальные данные из базы

### Обработка ошибок

- При ошибке загрузки данных показываются значения по умолчанию
- Добавлены сообщения об ошибках в консоль
- Пользователь видит "Ошибка загрузки" вместо реальных данных

## Тестирование

Для тестирования API можно использовать скрипт `test_dashboard_api.py`:

```bash
python test_dashboard_api.py
```

## Запуск

1. Запустите бэкенд:
```bash
cd wildfire-backend
python -m uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

2. Запустите фронтенд:
```bash
cd frontend
npm run dev
```

3. Откройте браузер и перейдите на главную страницу

## Примечания

- Метрика "Активные команды" пока использует фиксированное значение, так как нет соответствующей модели в базе данных
- В случае отсутствия данных в базе используются значения по умолчанию
- Все метрики обновляются при загрузке страницы

